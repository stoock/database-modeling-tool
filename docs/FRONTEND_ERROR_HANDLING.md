# ν”„λ΅ νΈμ—”λ“ μ—λ¬ μ²λ¦¬ κ°€μ΄λ“

## κ°μ”

ν”„λ΅ νΈμ—”λ“λ” λ‹¤μΈµ μ—λ¬ μ²λ¦¬ μ‹μ¤ν…μΌλ΅ μ‚¬μ©μμ—κ² λ…ν™•ν• ν”Όλ“λ°±μ„ μ κ³µν•©λ‹λ‹¤.

## μ—λ¬ μ²λ¦¬ κ³„μΈµ

### 1. λ„¤νΈμ›ν¬ μƒνƒ λ¨λ‹ν„°λ§

**NetworkStatus μ»΄ν¬λ„νΈ**κ°€ μΈν„°λ„· μ—°κ²° μƒνƒλ¥Ό μ‹¤μ‹κ°„μΌλ΅ κ°μ§€ν•©λ‹λ‹¤.

```typescript
// μλ™μΌλ΅ App.tsxμ— ν¬ν•¨λ¨
<NetworkStatus />
```

**λ™μ‘:**
- μ¤ν”„λΌμΈ μ „ν™ μ‹: λ…Έλ€μƒ‰ κ²½κ³  λ°°λ„ ν‘μ‹ + ν† μ¤νΈ μ•λ¦Ό
- μ¨λΌμΈ λ³µκµ¬ μ‹: λ°°λ„ μ κ±° + μ„±κ³µ ν† μ¤νΈ μ•λ¦Ό

### 2. μ„λ²„ ν—¬μ¤ μ²΄ν¬

**useServerHealth ν›…**μ΄ λ°±μ—”λ“ μ„λ²„ μƒνƒλ¥Ό μ£ΌκΈ°μ μΌλ΅ ν™•μΈν•©λ‹λ‹¤.

```typescript
// App.tsxμ—μ„ μλ™ μ‹¤ν–‰
useServerHealth({
  enabled: true,
  interval: 60000, // 1λ¶„λ§λ‹¤ μ²΄ν¬
  showToast: true,
});
```

**μ²΄ν¬ ν•­λ©:**
- λ°±μ—”λ“ μ„λ²„ μ—°κ²° μƒνƒ
- PostgreSQL λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μƒνƒ
- μ„λΉ„μ¤ μ „λ°μ μΈ κ±΄κ°•λ„

**μ•λ¦Ό μ‹λ‚λ¦¬μ¤:**

| μƒνƒ | ν† μ¤νΈ νƒ€μ… | λ©”μ‹μ§€ |
|------|------------|--------|
| μ„λ²„ μ—°κ²° μ‹¤ν¨ | Error (λΉ¨κ°•) | "λ°±μ—”λ“ μ„λ²„μ— μ—°κ²°ν•  μ μ—†μµλ‹λ‹¤" |
| DB μ—°κ²° μ‹¤ν¨ | Warning (λ…Έλ‘) | "PostgreSQL μ—°κ²°μ„ ν™•μΈν•΄μ£Όμ„Έμ”" |
| μ„λ²„ λ³µκµ¬ | Success (μ΄λ΅) | "λ°±μ—”λ“ μ„λ²„κ°€ μ •μƒμ μΌλ΅ μ‘λ™ν•©λ‹λ‹¤" |

### 3. API μΈν„°μ…‰ν„°

**axios μΈν„°μ…‰ν„°**κ°€ λ¨λ“  HTTP μ”μ²­/μ‘λ‹µμ„ κ°€λ΅μ±„μ„ μ—λ¬λ¥Ό μ²λ¦¬ν•©λ‹λ‹¤.

```typescript
// lib/api.tsμ—μ„ μλ™ μ„¤μ •
apiClient.interceptors.response.use(
  (response) => response,
  (error) => {
    // μ—λ¬ νμ‹± λ° ν† μ¤νΈ ν‘μ‹
    const errorInfo = parseAxiosError(error);
    toastStore.error(errorInfo.title, errorInfo.message);
    return Promise.reject(error);
  }
);
```

**HTTP μƒνƒ μ½”λ“λ³„ λ©”μ‹μ§€:**

| μ½”λ“ | μ λ© | λ©”μ‹μ§€ | νƒ€μ… |
|------|------|--------|------|
| 400 | μλ»λ μ”μ²­ | μ”μ²­ λ°μ΄ν„°λ¥Ό ν™•μΈν•΄μ£Όμ„Έμ” | VALIDATION |
| 401 | μΈμ¦ ν•„μ” | λ΅κ·ΈμΈμ΄ ν•„μ”ν•©λ‹λ‹¤ | UNAUTHORIZED |
| 403 | μ ‘κ·Ό κ±°λ¶€ | μ΄ μ‘μ—…μ„ μν–‰ν•  κ¶ν•μ΄ μ—†μµλ‹λ‹¤ | FORBIDDEN |
| 404 | λ¦¬μ†μ¤ μ—†μ | μ”μ²­ν• λ¦¬μ†μ¤λ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤ | NOT_FOUND |
| 409 | μ¤‘λ³µ λ°μ΄ν„° | μ΄λ―Έ μ΅΄μ¬ν•λ” λ°μ΄ν„°μ…λ‹λ‹¤ | CONFLICT |
| 422 | κ²€μ¦ μ‹¤ν¨ | μ…λ ¥ λ°μ΄ν„°κ°€ μ ν¨ν•μ§€ μ•μµλ‹λ‹¤ | VALIDATION |
| 500 | μ„λ²„ μ¤λ¥ | μ„λ²„μ—μ„ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤ | SERVER |
| 503 | μ„λΉ„μ¤ μ΄μ© λ¶κ°€ | λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²°μ— μ‹¤ν¨ν–μµλ‹λ‹¤ | SERVER |
| 504 | νƒ€μ„μ•„μ›ƒ | μ”μ²­ μ‹κ°„μ΄ μ΄κ³Όλμ—μµλ‹λ‹¤ | TIMEOUT |
| - | μ„λ²„ μ—°κ²° μ‹¤ν¨ | λ°±μ—”λ“ μ„λ²„μ— μ—°κ²°ν•  μ μ—†μµλ‹λ‹¤ (http://localhost:8080) | NETWORK |

### 4. μ—λ¬ λ°”μ΄λ”λ¦¬

**ErrorBoundary μ»΄ν¬λ„νΈ**κ°€ React μ»΄ν¬λ„νΈ νΈλ¦¬μ μ—λ¬λ¥Ό μΊμΉν•©λ‹λ‹¤.

```typescript
// App.tsxμ—μ„ μ „μ²΄ μ•±μ„ κ°μ
<ErrorBoundary>
  <App />
</ErrorBoundary>
```

**λ™μ‘:**
- μ»΄ν¬λ„νΈ λ λ”λ§ μ¤‘ μ—λ¬ λ°μƒ μ‹ ν΄λ°± UI ν‘μ‹
- μ—λ¬ μ •λ³΄λ¥Ό μ½μ†”μ— λ΅κΉ… (κ°λ° ν™κ²½)
- μ‚¬μ©μμ—κ² μΉν™”μ μΈ μ—λ¬ λ©”μ‹μ§€ ν‘μ‹

## μ‚¬μ©μ μ‹λ‚λ¦¬μ¤λ³„ μ—λ¬ μ²λ¦¬

### μ‹λ‚λ¦¬μ¤ 1: PostgreSQLμ΄ μ‹¤ν–‰λμ§€ μ•μ

**μ¦μƒ:**
- λ°±μ—”λ“λ” μ‹¤ν–‰ μ¤‘μ΄μ§€λ§ λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μ‹¤ν¨

**ν”„λ΅ νΈμ—”λ“ λ™μ‘:**
1. μ΄κΈ° API νΈμ¶ μ‹ 503 μ—λ¬ λ°μƒ
2. ν† μ¤νΈ ν‘μ‹: "λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²°μ— μ‹¤ν¨ν–μµλ‹λ‹¤. PostgreSQLμ΄ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈν•΄μ£Όμ„Έμ”."
3. 1λ¶„λ§λ‹¤ ν—¬μ¤ μ²΄ν¬λ΅ μƒνƒ μ¬ν™•μΈ
4. λ³µκµ¬ μ‹ μ„±κ³µ ν† μ¤νΈ ν‘μ‹

**ν•΄κ²° λ°©λ²•:**
```powershell
# PostgreSQL μ‹μ‘
.\scripts\01-env-setup.ps1
# λλ”
docker-compose up -d
```

### μ‹λ‚λ¦¬μ¤ 2: λ°±μ—”λ“ μ„λ²„κ°€ μ‹¤ν–‰λμ§€ μ•μ

**μ¦μƒ:**
- λ°±μ—”λ“ μ„λ²„ μμ²΄κ°€ μ¤‘μ§€λ¨

**ν”„λ΅ νΈμ—”λ“ λ™μ‘:**
1. API νΈμ¶ μ‹ λ„¤νΈμ›ν¬ μ—λ¬ λ°μƒ
2. ν† μ¤νΈ ν‘μ‹: "λ°±μ—”λ“ μ„λ²„μ— μ—°κ²°ν•  μ μ—†μµλ‹λ‹¤. μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈν•΄μ£Όμ„Έμ”. (http://localhost:8080)"
3. 1λ¶„λ§λ‹¤ ν—¬μ¤ μ²΄ν¬λ΅ μ—°κ²° μ¬μ‹λ„
4. λ³µκµ¬ μ‹ μ„±κ³µ ν† μ¤νΈ ν‘μ‹

**ν•΄κ²° λ°©λ²•:**
```powershell
# λ°±μ—”λ“ μ‹μ‘
cd backend
./gradlew bootRunDev
```

### μ‹λ‚λ¦¬μ¤ 3: μΈν„°λ„· μ—°κ²° λκΉ€

**μ¦μƒ:**
- μ‚¬μ©μμ μΈν„°λ„· μ—°κ²°μ΄ λμ–΄μ§

**ν”„λ΅ νΈμ—”λ“ λ™μ‘:**
1. λΈλΌμ°μ €μ `offline` μ΄λ²¤νΈ κ°μ§€
2. ν™”λ©΄ ν•λ‹¨μ— λ…Έλ€μƒ‰ λ°°λ„ ν‘μ‹: "μ¤ν”„λΌμΈ"
3. ν† μ¤νΈ ν‘μ‹: "μΈν„°λ„· μ—°κ²°μ„ ν™•μΈν•΄μ£Όμ„Έμ”"
4. μ¨λΌμΈ λ³µκµ¬ μ‹ λ°°λ„ μ κ±° + μ„±κ³µ ν† μ¤νΈ

### μ‹λ‚λ¦¬μ¤ 4: API μ”μ²­ νƒ€μ„μ•„μ›ƒ

**μ¦μƒ:**
- μ„λ²„ μ‘λ‹µμ΄ 30μ΄ μ΄μƒ μ§€μ—°

**ν”„λ΅ νΈμ—”λ“ λ™μ‘:**
1. axios timeout μ„¤μ •μ— μν•΄ μ”μ²­ μ·¨μ†
2. ν† μ¤νΈ ν‘μ‹: "μ”μ²­ μ‹κ°„μ΄ μ΄κ³Όλμ—μµλ‹λ‹¤. μ μ‹ ν›„ λ‹¤μ‹ μ‹λ„ν•΄μ£Όμ„Έμ”."
3. μ¬μ‹λ„ κ°€λ¥ν• μ—λ¬λ΅ λ¶„λ¥

### μ‹λ‚λ¦¬μ¤ 5: κ²€μ¦ μ—λ¬

**μ¦μƒ:**
- μ„λ²„μ—μ„ μ…λ ¥ λ°μ΄ν„° κ²€μ¦ μ‹¤ν¨

**ν”„λ΅ νΈμ—”λ“ λ™μ‘:**
1. 422 μƒνƒ μ½”λ“ μμ‹ 
2. μ„λ²„μ—μ„ μ κ³µν• μƒμ„Έ μ—λ¬ λ©”μ‹μ§€ νμ‹±
3. ν† μ¤νΈμ— ν•„λ“λ³„ μ—λ¬ ν‘μ‹:
   ```
   κ²€μ¦ μ‹¤ν¨
   
   name: μ΄λ¦„μ€ ν•„μμ…λ‹λ‹¤, μ΄λ¦„μ€ 100μ μ΄ν•μ—¬μ•Ό ν•©λ‹λ‹¤
   email: μ ν¨ν• μ΄λ©”μΌ μ£Όμ†λ¥Ό μ…λ ¥ν•μ„Έμ”
   ```

## κ°λ°μ κ°€μ΄λ“

### API νΈμ¶ μ‹ μ—λ¬ μ²λ¦¬

**κΈ°λ³Έ μ‚¬μ© (μλ™ μ—λ¬ μ²λ¦¬):**
```typescript
import { createProject } from '@/lib/api';

// μ—λ¬λ” μλ™μΌλ΅ ν† μ¤νΈλ΅ ν‘μ‹λ¨
const project = await createProject({ name: 'New Project' });
```

**μ»¤μ¤ν…€ μ—λ¬ μ²λ¦¬:**
```typescript
import { useAsyncError } from '@/hooks/useAsyncError';

const handleError = useAsyncError();

try {
  await someOperation();
} catch (error) {
  handleError(error, 'μ»¤μ¤ν…€ μ—λ¬ λ©”μ‹μ§€');
}
```

**λΉ„λ™κΈ° μ‘μ—… λνΌ:**
```typescript
import { useAsyncWrapper } from '@/hooks/useAsyncError';

const wrapAsync = useAsyncWrapper();

const handleSubmit = wrapAsync(
  async (data) => {
    await createProject(data);
  },
  {
    errorMessage: 'ν”„λ΅μ νΈ μƒμ„±μ— μ‹¤ν¨ν–μµλ‹λ‹¤',
    onError: (error) => {
      // μ¶”κ°€ μ—λ¬ μ²λ¦¬
    }
  }
);
```

### ν† μ¤νΈ μ§μ ‘ ν‘μ‹

```typescript
import { useToastStore } from '@/stores/toastStore';

const { success, error, warning, info } = useToastStore();

// μ„±κ³µ
success('μ„±κ³µ', 'μ‘μ—…μ΄ μ™„λ£λμ—μµλ‹λ‹¤');

// μ—λ¬
error('μ¤λ¥', 'μ‘μ—… μ‹¤ν–‰ μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤');

// κ²½κ³ 
warning('κ²½κ³ ', 'μ΄ μ‘μ—…μ€ λλλ¦΄ μ μ—†μµλ‹λ‹¤');

// μ •λ³΄
info('μ•λ¦Ό', 'μƒλ΅μ΄ μ—…λ°μ΄νΈκ°€ μμµλ‹λ‹¤');
```

### μ„λ²„ ν—¬μ¤ μ²΄ν¬ μ»¤μ¤ν„°λ§μ΄μ§•

```typescript
import { useServerHealth } from '@/hooks/useServerHealth';

const { isHealthy, lastCheck, healthStatus } = useServerHealth({
  enabled: true,
  interval: 30000, // 30μ΄λ§λ‹¤ μ²΄ν¬
  showToast: false, // ν† μ¤νΈ λΉ„ν™μ„±ν™”
});

// μƒνƒμ— λ”°λ¥Έ UI ν‘μ‹
if (!isHealthy) {
  return <div>μ„λ²„ μ—°κ²° λ¶κ°€</div>;
}
```

## μ—λ¬ λ΅κΉ…

### κ°λ° ν™κ²½

λ¨λ“  μ—λ¬κ°€ μ½μ†”μ— μλ™μΌλ΅ λ΅κΉ…λ©λ‹λ‹¤:

```
π”΄ μ„λ²„ μ¤λ¥
Message: μ„λ²„μ—μ„ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤
Type: SERVER
Status Code: 500
Original Error: [AxiosError object]
```

### ν”„λ΅λ•μ… ν™κ²½

ν”„λ΅λ•μ…μ—μ„λ” μ—λ¬ λ¦¬ν¬ν… μ„λΉ„μ¤λ΅ μ „μ†΅ν•  μ μμµλ‹λ‹¤:

```typescript
// lib/errorHandler.ts
export function logError(errorInfo: ErrorInfo): void {
  if (import.meta.env.PROD) {
    // Sentry, LogRocket λ“±μΌλ΅ μ „μ†΅
    Sentry.captureException(errorInfo.originalError, {
      extra: {
        type: errorInfo.type,
        message: errorInfo.message,
        statusCode: errorInfo.statusCode,
      },
    });
  }
}
```

## μ ‘κ·Όμ„± (Accessibility)

### μ¤ν¬λ¦° λ¦¬λ” μ§€μ›

μ—λ¬ λ©”μ‹μ§€λ” ARIA live regionμ„ ν†µν•΄ μ¤ν¬λ¦° λ¦¬λ”μ— μλ™μΌλ΅ μ•λ¦½λ‹λ‹¤:

```html
<div
  role="status"
  aria-live="polite"
  aria-atomic="true"
  className="sr-only"
  id="aria-live-region"
/>
```

### ν‚¤λ³΄λ“ λ„¤λΉ„κ²μ΄μ…

ν† μ¤νΈ λ©”μ‹μ§€λ” ν‚¤λ³΄λ“λ΅ λ‹«μ„ μ μμµλ‹λ‹¤:
- `Esc` ν‚¤: ν„μ¬ ν† μ¤νΈ λ‹«κΈ°
- `Tab` ν‚¤: ν† μ¤νΈ κ°„ μ΄λ™

## λ¨λ²” μ‚¬λ΅€

1. **API νΈμ¶μ€ try-catch μ—†μ΄ μ‚¬μ©**: μΈν„°μ…‰ν„°κ°€ μλ™ μ²λ¦¬
2. **μ„±κ³µ λ©”μ‹μ§€λ” λ…μ‹μ μΌλ΅ ν‘μ‹**: μ‚¬μ©μ ν”Όλ“λ°± μ¤‘μ”
3. **μ¬μ‹λ„ κ°€λ¥ν• μ—λ¬λ” μ•λ‚΄ μ¶”κ°€**: "μ μ‹ ν›„ λ‹¤μ‹ μ‹λ„ν•΄μ£Όμ„Έμ”"
4. **κ²€μ¦ μ—λ¬λ” ν•„λ“λ³„λ΅ ν‘μ‹**: μ‚¬μ©μκ°€ μμ •ν•  λ¶€λ¶„ λ…ν™•ν
5. **λ„¤νΈμ›ν¬ μμ΅΄ κΈ°λ¥μ€ μƒνƒ ν™•μΈ**: `useServerHealth` ν™μ©

## ν…μ¤νΈ

### μ—λ¬ μ‹λ‚λ¦¬μ¤ ν…μ¤νΈ

```typescript
// λ°±μ—”λ“ μ¤‘μ§€ ν›„ ν…μ¤νΈ
describe('Server Connection Error', () => {
  it('should show error toast when server is down', async () => {
    // λ°±μ—”λ“ μ„λ²„ μ¤‘μ§€
    // API νΈμ¶
    // μ—λ¬ ν† μ¤νΈ ν™•μΈ
  });
});

// PostgreSQL μ¤‘μ§€ ν›„ ν…μ¤νΈ
describe('Database Connection Error', () => {
  it('should show warning toast when database is down', async () => {
    // PostgreSQL μ¤‘μ§€
    // ν—¬μ¤ μ²΄ν¬ λ€κΈ°
    // κ²½κ³  ν† μ¤νΈ ν™•μΈ
  });
});
```

## μ°Έκ³  μλ£

- [μ—λ¬ ν•Έλ“¤λ¬ κµ¬ν„](../frontend/src/lib/errorHandler.ts)
- [API ν΄λΌμ΄μ–ΈνΈ](../frontend/src/lib/api.ts)
- [μ„λ²„ ν—¬μ¤ μ²΄ν¬ ν›…](../frontend/src/hooks/useServerHealth.ts)
- [λ„¤νΈμ›ν¬ μƒνƒ μ»΄ν¬λ„νΈ](../frontend/src/components/common/NetworkStatus.tsx)
- [μ—λ¬ μ²λ¦¬ μƒμ„Έ κ°€μ΄λ“](../frontend/src/lib/ERROR_HANDLING_GUIDE.md)
